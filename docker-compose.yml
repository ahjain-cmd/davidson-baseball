services:
  app:
    build: .
    ports:
      - "8501:8501"
    volumes:
      # Mount your data files into the container
      - ${DATA_DIR:-.}/all_trackman.parquet:/app/all_trackman.parquet:ro
      - ${DATA_DIR:-.}/all_trackman_fixed.parquet:/app/all_trackman_fixed.parquet:ro
      - ${DATA_DIR:-.}/davidson.duckdb:/app/davidson.duckdb:ro
      # Mount cache directory for fast league percentile loading
      - ${DATA_DIR:-.}/.cache:/app/.cache
      # Optional: mount TrueMedia data
      - ${DATA_DIR:-.}/export.json:/app/export.json:ro
    environment:
      - STREAMLIT_SERVER_MAX_UPLOAD_SIZE=500
      - TM_MASTER_TOKEN=${TM_MASTER_TOKEN}
      - TM_USERNAME=${TM_USERNAME}
      - TM_SITENAME=${TM_SITENAME}
    restart: unless-stopped
